# 智享进销存管理系统业务逻辑文档

## 系统概述
本系统是一个完整的智享进销存管理系统，支持商品管理、库存管理、订单管理、客户管理、供应商管理、会员管理（付费用户）和财务管理等功能。

## 核心业务模块

### 1. 会员系统（付费用户系统）

#### 1.1 会员定义
- 会员是付费使用本系统的用户，不是传统意义上的购买商品的客户
- 会员通过支付年费获得系统使用权限
- 不同等级的会员享有不同的功能权限和使用限制

#### 1.2 会员等级
- **基础版**：适合小微企业，支持基本的进销存功能
  - 年费：¥999
  - 最大用户数：1人
  - 最大商品数：100个
  - 最大订单数：1000个
  
- **专业版**：适合中小企业，支持完整功能
  - 年费：¥2999
  - 最大用户数：5人
  - 最大商品数：1000个
  - 最大订单数：10000个
  
- **企业版**：适合大型企业，无限制使用
  - 年费：¥9999
  - 无使用限制
  - 支持高级分析功能

#### 1.3 会员管理
- 会员注册和信息管理
- 会员费收取和到期提醒
- 会员权限控制
- 会员状态管理（正常、过期、暂停）

### 2. 客户管理
- 客户是购买商品的外部客户，与会员（付费用户）不同
- 支持客户信息管理、信用等级、联系方式等
- 客户可以关联销售订单

### 3. 订单与库存关联

#### 3.1 采购订单流程
1. **创建采购订单**（状态：PENDING）
   - 不影响库存
   - 记录采购计划

2. **确认采购订单**（状态：CONFIRMED）
   - 不影响库存
   - 向供应商确认订单

3. **收货确认**（状态：RECEIVED）
   - **自动增加库存**
   - 创建库存变动记录（PURCHASE_IN）
   - 更新商品库存数量

#### 3.2 销售订单流程
1. **创建销售订单**（状态：PENDING）
   - 不影响库存
   - 记录销售计划

2. **确认销售订单**（状态：CONFIRMED）
   - 不影响库存
   - 预留库存（可选功能）

3. **发货确认**（状态：SHIPPED）
   - 不影响库存
   - 记录发货信息

4. **完成销售**（状态：COMPLETED）
   - **自动减少库存**
   - 创建库存变动记录（SALE_OUT）
   - 检查库存是否足够

#### 3.3 库存检查机制
- 销售订单完成前检查库存是否足够
- 库存不足时阻止订单完成
- 支持库存预警功能（低于最小库存时提醒）

### 4. 库存管理

#### 4.1 库存变动类型
- **PURCHASE_IN**：采购入库
- **SALE_OUT**：销售出库
- **RETURN_IN**：退货入库
- **RETURN_OUT**：退货出库
- **ADJUST**：库存调整
- **TRANSFER**：库存调拨

#### 4.2 库存变动记录
- 记录每次库存变动的详细信息
- 包含变动类型、数量、原因、关联订单等
- 支持库存变动历史查询

#### 4.3 库存预警
- 设置商品最低库存预警线
- 库存低于预警线时系统提醒
- 支持库存报表和分析

### 5. 财务管理

#### 5.1 收支记录
- 自动记录订单相关的收支
- 支持手动添加其他收支记录
- 分类管理收支项目

#### 5.2 会员费管理
- 记录会员费收取情况
- 支持多种支付方式
- 自动更新会员到期时间

### 6. 数据关联关系

#### 6.1 订单关联
- 采购订单 ↔ 供应商
- 销售订单 ↔ 客户/会员
- 订单 ↔ 商品（订单明细）
- 订单 ↔ 库存变动记录

#### 6.2 会员关联
- 会员 ↔ 会员等级
- 会员 ↔ 会员费支付记录
- 会员 ↔ 销售订单（可选）

#### 6.3 商品关联
- 商品 ↔ 分类
- 商品 ↔ 库存变动记录
- 商品 ↔ 订单明细

### 7. 业务流程示例

#### 7.1 完整的采购流程
1. 创建供应商"苹果供应商"
2. 创建商品"iPhone 15"（初始库存0）
3. 创建采购订单PO001，采购10个iPhone 15
4. 订单状态更新为RECEIVED
5. 系统自动：
   - iPhone 15库存从0增加到10
   - 创建库存变动记录（PURCHASE_IN，+10）

#### 7.2 完整的销售流程
1. 创建客户"张三公司"
2. 创建销售订单SO001，销售2个iPhone 15
3. 订单状态更新为COMPLETED
4. 系统自动：
   - 检查库存（当前10个，需要2个，足够）
   - iPhone 15库存从10减少到8
   - 创建库存变动记录（SALE_OUT，-2）

#### 7.3 会员管理流程
1. 创建会员等级"专业版"（年费2999元）
2. 注册会员"ABC公司"
3. 收取会员费2999元
4. 设置会员到期时间为1年后
5. 会员可以使用系统的专业版功能

### 8. 数据一致性保证

#### 8.1 事务处理
- 订单状态变更和库存更新在同一事务中
- 确保数据一致性
- 失败时自动回滚

#### 8.2 约束检查
- 库存不能为负数
- 销售数量不能超过库存
- 会员费必须大于0
- 订单金额必须大于0

#### 8.3 数据验证
- 商品SKU唯一性
- 订单编号唯一性
- 会员编号唯一性
- 手机号唯一性（可选）

### 9. 扩展功能建议

#### 9.1 高级库存管理
- 批次管理
- 序列号管理
- 保质期管理
- 多仓库管理

#### 9.2 高级会员功能
- API访问权限
- 数据导出权限
- 高级报表功能
- 多公司管理

#### 9.3 业务分析
- 销售趋势分析
- 库存周转分析
- 客户价值分析
- 会员使用情况分析

#### 9.4 系统集成
- 电商平台对接
- 财务软件集成
- 物流系统集成
- 支付系统集成

## 总结

本系统通过完善的业务逻辑设计，实现了：
1. **会员付费模式**：通过会员费获得系统使用权
2. **自动化库存管理**：订单状态变更自动影响库存
3. **完整的业务闭环**：从采购到销售的完整流程
4. **数据一致性保证**：通过事务和约束确保数据准确性
5. **灵活的扩展性**：支持未来功能扩展和业务发展

系统设计遵循了现代SaaS软件的最佳实践，为企业提供了一个可靠、高效的进销存管理解决方案。 